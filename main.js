(()=>{"use strict";var e=function(e,t,r){var n=r.inactiveButtonClass;!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n),t.removeAttribute("disabled")):(t.classList.add(n),t.setAttribute("disabled",!0))},t=document.querySelector(".popup__picture-image"),r=document.querySelector(".popup__picture-figcaption"),n=document.querySelector(".popup_picture"),o=document.querySelector(".popup_profile-edit"),c=o.querySelector(".popup_edit_form"),u=document.querySelector(".popup_avatar-edit"),a=u.querySelector(".popup_avatar_form");function s(e){e.querySelector(".popup__button-submit"),e.classList.add("popup_opened"),document.addEventListener("keydown",i),e.addEventListener("mousedown",l)}var i=function(e){"Escape"===e.key&&d(document.querySelector(".popup_opened"))},l=function(e){e.target===e.currentTarget&&d(e.currentTarget)};function d(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",i),e.removeEventListener("mousedown",l)}var p={baseUrl:"https://nomoreparties.co/v1/plus-cohort-15",headers:{authorization:"50cb73c3-cd63-4207-b16a-8317dc26240b","Content-Type":"application/json"}},m=function(e,t){return fetch("".concat(p.baseUrl,"/cards/likes/").concat(t),{method:e,headers:p.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.error(e)}))},f=document.querySelector("#element__template"),_=document.querySelector(".elements__list"),v=document.querySelector(".popup_add-picture"),y=v.querySelector(".popup_add_form"),b=y.querySelector('input[name="popup_input-title"]'),h=y.querySelector('input[name="popup_input-link"]'),S=document.querySelector(".popup__button-submit-picture"),C="dedae49c75f881debabf24b5";function q(e){e.target.closest(".elements__element").remove()}function E(e,o,c,u,a,i){var l=f.content.querySelector(".elements__element").cloneNode(!0),d=l.querySelector(".elements__picture"),_=l.querySelector(".elements__like-number"),v=l.querySelector(".elements__delete"),y=l.querySelector(".elements__like");if(u!==C&&v.classList.add("elements_delete_disable"),v.addEventListener("click",(function(){!function(e){fetch("".concat(p.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:p.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.error(e)}))}(a)})),d.src=o,d.alt=e,_.textContent=c,l.querySelector(".elements__name").textContent=e,void 0!==i)for(var b=0;b<i.length;b++)i[b]._id===C&&y.classList.add("elements_like_active");return y.addEventListener("click",(function(e){e.target.classList.toggle("elements_like_active"),e.target.classList.contains("elements_like_active")?(m("PUT",a),c+=1,_.textContent=c):(m("DELETE",a),c-=1,_.textContent=c)})),v.addEventListener("click",q),d.addEventListener("click",(function(){return function(e,o){t.setAttribute("src",e),t.setAttribute("alt",o),r.textContent=o,s(n)}(o,e)})),l}var L,k,g,x,j,A,B,P,T,U,D=document.querySelector(".profile__name"),w=document.querySelector(".profile__description"),N=document.querySelector(".profile__avatar"),O=c.querySelector('input[name="popup_edit-input-name"]'),J=c.querySelector('input[name="popup_edit-input-description"]'),M=a.querySelector('input[name="popup_input-avatar"]'),G=document.querySelector(".profile__avatar"),H=document.querySelector(".popup__button-submit-avatar"),I=document.querySelector(".popup__button-submit-profile"),V=document.querySelector(".profile__edit-button"),z=document.querySelector(".profile__add-button"),F=document.querySelectorAll(".popup__close-button"),K=document.querySelector(".profile__avatar-button");V.addEventListener("click",(function(){s(o),O.value=D.textContent,J.value=w.textContent})),K.addEventListener("click",(function(){s(u)})),F.forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return d(t)}))})),z.addEventListener("click",(function(){s(v)})),c.addEventListener("submit",(function(e){I.textContent="Сохранение",e.preventDefault(),D.textContent=O.value,function(e,t){return fetch("".concat(p.baseUrl,"/users/me"),{method:"PATCH",headers:p.headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.error(e)}))}(O.value,J.value).then((function(e){I.textContent="Сохранить"})),w.textContent=J.value,d(o)})),y.addEventListener("submit",(function(e){var t,r;S.textContent="Сохранение",e.preventDefault(),(t=b.value,r=h.value,fetch("".concat(p.baseUrl,"/cards"),{method:"POST",headers:p.headers,body:JSON.stringify({name:t,link:r})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.error(e)}))).then((function(e){S.textContent="Сохранить"})),_.prepend(E(b.value,h.value)),y.reset(),e.submitter.classList.add("popup_button-submit-disabled"),e.submitter.setAttribute("disabled",!0),d(v)})),a.addEventListener("submit",(function(e){var t;H.textContent="Сохранение",e.preventDefault(),(t=M.value,fetch("".concat(p.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:p.headers,body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.error(e)}))).then((function(e){H.textContent="Сохранить"})),G.style.backgroundImage="url(".concat(M.value,")"),d(u)})),k=(L={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-submit",inactiveButtonClass:"popup_button-submit-disabled",inputErrorClass:"form_input_type_error",errorClass:"form_input-error_active"}).formSelector,g=L.inputSelector,x=L.submitButtonSelector,j=L.inactiveButtonClass,A=L.inputErrorClass,B=L.errorClass,Array.from(document.querySelectorAll(k)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),Array.from(t.querySelectorAll(".form__set")).forEach((function(t){!function(t,r){var n=r.inputSelector,o=r.submitButtonSelector,c=r.inactiveButtonClass,u=r.inputErrorClass,a=r.errorClass,s=Array.from(t.querySelectorAll(n)),i=t.querySelector(o);e(s,i,{inactiveButtonClass:c}),s.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,r){var n=r.inputErrorClass,o=r.errorClass;t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?function(e,t,r){var n=r.inputErrorClass,o=r.errorClass,c=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n),c.classList.remove(o),c.textContent=""}(e,t,{inputErrorClass:n,errorClass:o}):function(e,t,r,n){var o=n.inputErrorClass,c=n.errorClass,u=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o),u.textContent=r,u.classList.add(c)}(e,t,t.validationMessage,{inputErrorClass:n,errorClass:o})}(t,r,{inputErrorClass:u,errorClass:a}),e(s,i,{inactiveButtonClass:c})}))}))}(t,{inputSelector:g,submitButtonSelector:x,inactiveButtonClass:j,inputErrorClass:A,errorClass:B})}))})),P=D,T=w,U=N,fetch("".concat(p.baseUrl,"/users/me"),{method:"GET",headers:p.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.error(e)})).then((function(e){P.textContent=e.name,T.textContent=e.about,U.style.backgroundImage="url(".concat(e.avatar,")")})),fetch("".concat(p.baseUrl,"/cards"),{method:"GET",headers:p.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.error(e)})).then((function(e){for(var t=0;t<e.length;t++)_.append(E(e[t].name,e[t].link,e[t].likes.length,e[t].owner._id,e[t]._id,e[t].likes))}))})();